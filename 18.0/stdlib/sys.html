<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>sys (stdlib) -  (Erlang Documentation)</title>
    <link href="../erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-44246018-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        
  
  <h1>sys</h1>
  <h2 class="modsummary">A Functional Interface to System Messages</h2>
  <div class="description">
    <p>This module contains functions for sending system messages used by programs, and messages used for debugging purposes.
      </p>
    <p>Functions used for implementation of processes 
      should also understand system messages such as debugging
      messages and code change. These functions must be used to implement the use of system messages for a process; either directly, or through standard behaviours, such as <code>gen_server</code>.</p>
    <p>The default timeout is 5000 ms, unless otherwise specified. The
      <code>timeout</code> defines the time period to wait for the process to
      respond to a request. If the process does not respond, the
      function evaluates <code>exit({timeout, {M, F, A}})</code>.
      </p>
    <p><span id="dbg_opt"> </span>The functions make reference to a debug structure.
      The debug structure is a list of <code>dbg_opt()</code>.
      <code>dbg_opt()</code> is an internal data type used by the
      <code>handle_system_msg/6</code> function. No debugging is performed if it is an empty list.
      </p>
  </div>

  <div class="section">
    <h4>System Messages</h4>
    <p>Processes which are not implemented as one of the standard
      behaviours must still understand system
      messages. There are three different messages which must be
      understood:
      </p>
    <list type="bulleted">
      <item>
        <p>Plain system messages. These are received as
          <code>{system, From, Msg}</code>. The content and meaning of
          this message are not interpreted by the
          receiving process module. When a system message has been
          received, the function <code>sys:handle_system_msg/6</code>
          is called in order to handle the request.
          </p>
      </item>
      <item>
        <p>Shutdown messages. If the process traps exits, it must
          be able to handle an shut-down request from its parent, the
          supervisor. The message <code>{'EXIT', Parent, Reason}</code>
          from the parent is an order to terminate.  The process must terminate when this message is received, normally with the
          same <code>Reason</code> as <code>Parent</code>.
          </p>
      </item>
      <item>
        <p>There is one more message which the process must understand if the modules used to implement the process change dynamically during runtime. An example of such a process is the <code>gen_event</code> processes. This message is <code>{get_modules, From}</code>. The reply to this message is <code>From ! {modules, Modules}</code>,
          where <code>Modules</code> is a list of the currently active modules in the process.
          </p>
        <p>This message is used by the release handler to find which
          processes execute a certain module. The process may at a
          later time be suspended and ordered to perform a code change
          for one of its modules.
          </p>
      </item>
    </list>
  </div>

  <div class="section">
    <h4>System Events</h4>
    <p>When debugging a process with the functions of this
      module, the process generates <em>system_events</em> which are
      then treated in the debug function. For example, <code>trace</code>
      formats the system events to the tty.
      </p>
    <p>There are three predefined system events which are used when a
      process receives or sends a message. The process can also define its
      own system events. It is always up to the process itself
      to format these events.</p>
  </div>
  <div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type">
      <h3 id="type-name">name() = pid() | atom() | {global, atom()}</h3>
    </div>
    <div class="type">
      <h3 id="type-system_event">system_event() = {in, Msg :: term()}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {in, Msg :: term(), From :: term()}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {out, Msg :: term(), To :: term()}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| term()</h3>
    </div>
    <div class="type">
      <h3 id="type-dbg_opt">dbg_opt()</h3>
      <div class="description"><p>See <a href="#dbg_opt" class="seealso">above</a>.</p></div>
    </div>
    <div class="type">
      <h3 id="type-dbg_fun">dbg_fun() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun((FuncState :: term(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Event :: <a href="#type-system_event" class="seealso">system_event()</a>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcState :: term()) -><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done | (NewFuncState :: term()))</h3>
    </div>
    <div class="type">
      <h3 id="type-format_fun">format_fun() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun((Device :: <a href="io.html#type-device" class="seealso">io:device()</a> | <a href="file.html#type-io_device" class="seealso">file:io_device()</a>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Event :: <a href="#type-system_event" class="seealso">system_event()</a>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Extra :: term()) -><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;any())</h3>
    </div>
  </div>
  <div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
    <div class="function">
      <h3 id="log/2">log(Name, Flag) -&gt; ok | {ok, [<a href="#type-system_event" class="seealso">system_event()</a>]}</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Flag = true | {true, N :: integer() &gt;= 1} | false | get | print</code></li></ul>
      <h3 id="log/3">log(Name, Flag, Timeout) -&gt; ok | {ok, [<a href="#type-system_event" class="seealso">system_event()</a>]}</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Flag = true | {true, N :: integer() &gt;= 1} | false | get | print</code></li><li><code>Timeout = timeout()</code></li></ul>
      
      <div class="description">
        <p>Turns the logging of system events On or Off. If On, a
          maximum of <code><anno>N</anno></code>  events are kept in the
          debug structure (the default is 10). If <code><anno>Flag</anno></code> is <code>get</code>, a list of all
          logged events is returned. If <code><anno>Flag</anno></code> is <code>print</code>, the
          logged events are printed to <code>standard_io</code>. The events are
          formatted with a function that is defined by the process that
          generated the event (with a call to
          <code>sys:handle_debug/4</code>).</p>
      </div>
    </div>
    <div class="function">
      <h3 id="log_to_file/2">log_to_file(Name, Flag) -&gt; ok | {error, open_file}</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Flag = (FileName :: string()) | false</code></li></ul>
      <h3 id="log_to_file/3">log_to_file(Name, Flag, Timeout) -&gt; ok | {error, open_file}</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Flag = (FileName :: string()) | false</code></li><li><code>Timeout = timeout()</code></li></ul>
      
      <div class="description">
        <p>Enables or disables the logging of all system events in textual
          format to the file. The events are formatted with a function that is 
          defined by the process that generated the event (with a call
          to <code>sys:handle_debug/4</code>).</p>
      </div>
    </div>
    <div class="function">
      <h3 id="statistics/2">statistics(Name, Flag) -&gt; ok | {ok, Statistics}</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Flag = true | false | get</code></li><li><code>Statistics = [StatisticsTuple] | no_statistics</code></li><li><code>StatisticsTuple = {start_time, DateTime1}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {current_time, DateTime2}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {reductions, integer() &gt;= 0}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {messages_in, integer() &gt;= 0}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {messages_out, integer() &gt;= 0}</code></li><li><code>DateTime1 = DateTime2 = <a href="file.html#type-date_time" class="seealso">file:date_time()</a></code></li></ul>
      <h3 id="statistics/3">statistics(Name, Flag, Timeout) -&gt; ok | {ok, Statistics}</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Flag = true | false | get</code></li><li><code>Statistics = [StatisticsTuple] | no_statistics</code></li><li><code>StatisticsTuple = {start_time, DateTime1}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {current_time, DateTime2}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {reductions, integer() &gt;= 0}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {messages_in, integer() &gt;= 0}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {messages_out, integer() &gt;= 0}</code></li><li><code>DateTime1 = DateTime2 = <a href="file.html#type-date_time" class="seealso">file:date_time()</a></code></li><li><code>Timeout = timeout()</code></li></ul>
      
      <div class="description">
        <p>Enables or disables the collection of statistics. If <code><anno>Flag</anno></code> is
          <code>get</code>, the statistical collection is returned.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="trace/2">trace(Name, Flag) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Flag = boolean()</code></li></ul>
      <h3 id="trace/3">trace(Name, Flag, Timeout) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Flag = boolean()</code></li><li><code>Timeout = timeout()</code></li></ul>
      
      <div class="description">
        <p>Prints all system events on <code>standard_io</code>. The events are
          formatted with a function that is defined by the process that
          generated the event (with a call to
          <code>sys:handle_debug/4</code>).</p>
      </div>
    </div>
    <div class="function">
      <h3 id="no_debug/1">no_debug(Name) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li></ul>
      <h3 id="no_debug/2">no_debug(Name, Timeout) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Timeout = timeout()</code></li></ul>
      
      <div class="description">
        <p>Turns off all debugging for the process. This includes
          functions that have been installed explicitly with the
          <code>install</code> function, for example triggers.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="suspend/1">suspend(Name) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li></ul>
      <h3 id="suspend/2">suspend(Name, Timeout) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Timeout = timeout()</code></li></ul>
      
      <div class="description">
        <p>Suspends the process. When the process is suspended, it
          will only respond to other system messages, but not other
          messages.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="resume/1">resume(Name) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li></ul>
      <h3 id="resume/2">resume(Name, Timeout) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Timeout = timeout()</code></li></ul>
      
      <div class="description">
        <p>Resumes a suspended process.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="change_code/4">change_code(Name, Module, OldVsn, Extra) -&gt; ok | {error, Reason}</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Module = module()</code></li><li><code>OldVsn = undefined | term()</code></li><li><code>Extra = Reason = term()</code></li></ul>
      <h3 id="change_code/5">change_code(Name, Module, OldVsn, Extra, Timeout) -&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok | {error, Reason}</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Module = module()</code></li><li><code>OldVsn = undefined | term()</code></li><li><code>Extra = term()</code></li><li><code>Timeout = timeout()</code></li><li><code>Reason = term()</code></li></ul>
      
      <div class="description">
        <p>Tells the process to change code. The process must be
          suspended to handle this message. The <code><anno>Extra</anno></code> argument is
          reserved for each process to use as its own. The function
          <code><anno>Module</anno>:system_code_change/4</code> is called. <code><anno>OldVsn</anno></code> is
          the old version of the <code><anno>Module</anno></code>.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="get_status/1">get_status(Name) -&gt; Status</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Status = <br />&nbsp;&nbsp;&nbsp;&nbsp;{status, Pid :: pid(), {module, Module :: module()}, [SItem]}</code></li><li><code>SItem = (PDict :: [{Key :: term(), Value :: term()}])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (SysState :: running | suspended)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (Parent :: pid())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (Dbg :: [<a href="#type-dbg_opt" class="seealso">dbg_opt()</a>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (Misc :: term())</code></li></ul>
      <h3 id="get_status/2">get_status(Name, Timeout) -&gt; Status</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Timeout = timeout()</code></li><li><code>Status = <br />&nbsp;&nbsp;&nbsp;&nbsp;{status, Pid :: pid(), {module, Module :: module()}, [SItem]}</code></li><li><code>SItem = (PDict :: [{Key :: term(), Value :: term()}])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (SysState :: running | suspended)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (Parent :: pid())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (Dbg :: [<a href="#type-dbg_opt" class="seealso">dbg_opt()</a>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (Misc :: term())</code></li></ul>
      
      <div class="description">
        <p>Gets the status of the process.</p>
        <p>The value of <code><anno>Misc</anno></code> varies for different types of
          processes. For example, a <code>gen_server</code> process returns
          the callback module's state, a <code>gen_fsm</code> process
          returns information such as its current state name and state data,
          and a <code>gen_event</code> process returns information about each of its
          registered handlers. Callback modules for <code>gen_server</code>,
          <code>gen_fsm</code>, and <code>gen_event</code> can also customise the value
          of <code><anno>Misc</anno></code> by exporting a <code>format_status/2</code>
          function that contributes module-specific information;
          see <a href="../gen_server#Module/format_status/2.html" class="seealso">gen_server:format_status/2</a>,
          <a href="../gen_fsm#Module/format_status/2.html" class="seealso">gen_fsm:format_status/2</a>, and
          <a href="../gen_event#Module/format_status/2.html" class="seealso">gen_event:format_status/2</a>
          for more details.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="get_state/1">get_state(Name) -&gt; State</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>State = term()</code></li></ul>
      <h3 id="get_state/2">get_state(Name, Timeout) -&gt; State</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Timeout = timeout()</code></li><li><code>State = term()</code></li></ul>
      
      <div class="description">
        <p>Gets the state of the process.</p>
        <div class="note"><h2>Note!</h2>
          <p>These functions are intended only to help with debugging. They are provided for
            convenience, allowing developers to avoid having to create their own state extraction
            functions and also avoid having to interactively extract state from the return values of
            <code><a href="#get_status/1" class="seealso">get_status/1</a></code> or
            <code><a href="#get_status/2" class="seealso">get_status/2</a></code> while debugging.</p>
        </div>
        <p>The value of <code><anno>State</anno></code> varies for different types of
          processes. For a <code>gen_server</code> process, the returned <code><anno>State</anno></code>
          is simply the callback module's state. For a <code>gen_fsm</code> process,
          <code><anno>State</anno></code> is the tuple <code>{CurrentStateName, CurrentStateData}</code>.
          For a <code>gen_event</code> process, <code><anno>State</anno></code> a list of tuples,
          where each tuple corresponds to an event handler registered in the process and contains
          <code>{Module, Id, HandlerState}</code>, where <code>Module</code> is the event handler's module name,
          <code>Id</code> is the handler's ID (which is the value <code>false</code> if it was registered without
          an ID), and <code>HandlerState</code> is the handler's state.</p>
        <p>If the callback module exports a <code>system_get_state/1</code> function, it will be called in the
          target process to get its state. Its argument is the same as the <code>Misc</code> value returned by
          <a href="#get_status/1" class="seealso">get_status/1,2</a>, and the <code>system_get_state/1</code>
          function is expected to extract the callback module's state from it. The <code>system_get_state/1</code>
          function must return <code>{ok, State}</code> where <code>State</code> is the callback module's state.</p>
        <p>If the callback module does not export a <code>system_get_state/1</code> function, <code>get_state/1,2</code>
          assumes the <code>Misc</code> value is the callback module's state and returns it directly instead.</p>
        <p>If the callback module's <code>system_get_state/1</code> function crashes or throws an exception, the
          caller exits with error <code>{callback_failed, {Module, system_get_state}, {Class, Reason}}</code> where
          <code>Module</code> is the name of the callback module and <code>Class</code> and <code>Reason</code> indicate
          details of the exception.</p>
        <p>The <code>system_get_state/1</code> function is primarily useful for user-defined
          behaviours and modules that implement OTP <a href="#special_process" class="seealso">special
          processes</a>. The <code>gen_server</code>, <code>gen_fsm</code>, and <code>gen_event</code> OTP
          behaviour modules export this function, and so callback modules for those behaviours
          need not supply their own.</p>
        <p>To obtain more information about a process, including its state, see
          <a href="#get_status/1" class="seealso">get_status/1</a> and
          <a href="#get_status/2" class="seealso">get_status/2</a>.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="replace_state/2">replace_state(Name, StateFun) -&gt; NewState</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>StateFun = fun((State :: term()) -&gt; NewState :: term())</code></li><li><code>NewState = term()</code></li></ul>
      <h3 id="replace_state/3">replace_state(Name, StateFun, Timeout) -&gt; NewState</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>StateFun = fun((State :: term()) -&gt; NewState :: term())</code></li><li><code>Timeout = timeout()</code></li><li><code>NewState = term()</code></li></ul>
      
      <div class="description">
        <p>Replaces the state of the process, and returns the new state.</p>
        <div class="note"><h2>Note!</h2>
          <p>These functions are intended only to help with debugging, and they should not be
            be called from normal code. They are provided for convenience, allowing developers
            to avoid having to create their own custom state replacement functions.</p>
        </div>
        <p>The <code><anno>StateFun</anno></code> function provides a new state for the process.
          The <code><anno>State</anno></code> argument and <code><anno>NewState</anno></code> return value
          of <code><anno>StateFun</anno></code> vary for different types of processes. For a
          <code>gen_server</code> process, <code><anno>State</anno></code> is simply the callback module's
          state, and <code><anno>NewState</anno></code> is a new instance of that state. For a
          <code>gen_fsm</code> process, <code><anno>State</anno></code> is the tuple
          <code>{CurrentStateName, CurrentStateData}</code>, and <code><anno>NewState</anno></code>
          is a similar tuple that may contain a new state name, new state data, or both.
          For a <code>gen_event</code> process, <code><anno>State</anno></code> is the tuple
          <code>{Module, Id, HandlerState}</code> where <code>Module</code> is the event handler's module name,
          <code>Id</code> is the handler's ID (which is the value <code>false</code> if it was registered without
          an ID), and <code>HandlerState</code> is the handler's state. <code><anno>NewState</anno></code> is a
          similar tuple where <code>Module</code> and <code>Id</code> shall have the same values as in
          <code><anno>State</anno></code> but the value of <code>HandlerState</code> may be different. Returning
          a <code><anno>NewState</anno></code> whose <code>Module</code> or <code>Id</code> values differ from those of
          <code><anno>State</anno></code> will result in the event handler's state remaining unchanged. For a
          <code>gen_event</code> process, <code><anno>StateFun</anno></code> is called once for each event handler
          registered in the <code>gen_event</code> process.</p>
        <p>If a <code><anno>StateFun</anno></code> function decides not to effect any change in process
          state, then regardless of process type, it may simply return its <code><anno>State</anno></code>
          argument.</p>
        <p>If a <code><anno>StateFun</anno></code> function crashes or throws an exception, then
          for <code>gen_server</code> and <code>gen_fsm</code> processes, the original state of the process is
          unchanged. For <code>gen_event</code> processes, a crashing or failing <code><anno>StateFun</anno></code>
          function means that only the state of the particular event handler it was working on when it
          failed or crashed is unchanged; it can still succeed in changing the states of other event
          handlers registered in the same <code>gen_event</code> process.</p>
        <p>If the callback module exports a <code>system_replace_state/2</code> function, it will be called in the
          target process to replace its state using <code>StateFun</code>. Its two arguments are <code>StateFun</code>
          and <code>Misc</code>, where <code>Misc</code> is the same as the <code>Misc</code> value returned by
          <a href="#get_status/1" class="seealso">get_status/1,2</a>. A <code>system_replace_state/2</code> function
          is expected to return <code>{ok, NewState, NewMisc}</code> where <code>NewState</code> is the callback module's
          new state obtained by calling <code>StateFun</code>, and <code>NewMisc</code> is a possibly new value used to
          replace the original <code>Misc</code> (required since <code>Misc</code> often contains the callback
          module's state within it).</p>
        <p>If the callback module does not export a <code>system_replace_state/2</code> function,
          <code>replace_state/2,3</code> assumes the <code>Misc</code> value is the callback module's state, passes it
          to <code>StateFun</code> and uses the return value as both the new state and as the new value of
          <code>Misc</code>.</p>
        <p>If the callback module's <code>system_replace_state/2</code> function crashes or throws an exception,
          the caller exits with error <code>{callback_failed, {Module, system_replace_state}, {Class, Reason}}</code>
          where <code>Module</code> is the name of the callback module and <code>Class</code> and <code>Reason</code> indicate details
          of the exception. If the callback module does not provide a <code>system_replace_state/2</code> function and
          <code>StateFun</code> crashes or throws an exception, the caller exits with error
          <code>{callback_failed, StateFun, {Class, Reason}}</code>.</p>
        <p>The <code>system_replace_state/2</code> function is primarily useful for user-defined behaviours and
          modules that implement OTP <a href="#special_process" class="seealso">special processes</a>. The
          <code>gen_server</code>, <code>gen_fsm</code>, and <code>gen_event</code> OTP behaviour modules export this function,
          and so callback modules for those behaviours need not supply their own.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="install/2">install(Name, FuncSpec) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>FuncSpec = {Func, FuncState}</code></li><li><code>Func = <a href="#type-dbg_fun" class="seealso">dbg_fun()</a></code></li><li><code>FuncState = term()</code></li></ul>
      <h3 id="install/3">install(Name, FuncSpec, Timeout) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>FuncSpec = {Func, FuncState}</code></li><li><code>Func = <a href="#type-dbg_fun" class="seealso">dbg_fun()</a></code></li><li><code>FuncState = term()</code></li><li><code>Timeout = timeout()</code></li></ul>
      
      <div class="description">
        <p>This function makes it possible to install other debug
          functions than the ones defined above. An example of such a
          function is a trigger, a function that waits for some
          special event and performs some action when the event is
          generated. This could, for example, be turning on low level tracing.
          </p>
        <p><code><anno>Func</anno></code> is called whenever a system event is
          generated. This function should return <code>done</code>, or a new
          func state. In the first case, the function is removed. It is removed 
          if the function fails.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="remove/2">remove(Name, Func) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Func = <a href="#type-dbg_fun" class="seealso">dbg_fun()</a></code></li></ul>
      <h3 id="remove/3">remove(Name, Func, Timeout) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Func = <a href="#type-dbg_fun" class="seealso">dbg_fun()</a></code></li><li><code>Timeout = timeout()</code></li></ul>
      
      <div class="description">
        <p>Removes a previously installed debug function from the
          process. <code><anno>Func</anno></code> must be the same as previously
          installed.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="terminate/2">terminate(Name, Reason) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Reason = term()</code></li></ul>
      <h3 id="terminate/3">terminate(Name, Reason, Timeout) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Name = <a href="#type-name" class="seealso">name()</a></code></li><li><code>Reason = term()</code></li><li><code>Timeout = timeout()</code></li></ul>
      
      <div class="description">
        <p>This function orders the process to terminate with the
        given <code><anno>Reason</anno></code>. The termination is done
        asynchronously, so there is no guarantee that the process is
        actually terminated when the function returns.</p>
      </div>
    </div>
  </div>

  <div class="section">
    <h4>Process Implementation Functions</h4>
    <p><span id="special_process"> </span>The following functions are used when implementing a
      special process. This is an ordinary process which does not use a
      standard behaviour, but a process which understands the standard system messages.</p>
  </div>
  <div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
    <div class="function">
      <h3 id="debug_options/1">debug_options(Options) -&gt; [<a href="#type-dbg_opt" class="seealso">dbg_opt()</a>]</h3>
      <ul class="type_desc"><li><code>Options = [Opt]</code></li><li><code>Opt = trace<br />&nbsp;&nbsp;&nbsp;&nbsp;| log<br />&nbsp;&nbsp;&nbsp;&nbsp;| {log, integer() &gt;= 1}<br />&nbsp;&nbsp;&nbsp;&nbsp;| statistics<br />&nbsp;&nbsp;&nbsp;&nbsp;| {log_to_file, FileName}<br />&nbsp;&nbsp;&nbsp;&nbsp;| {install, FuncSpec}</code></li><li><code>FileName = <a href="file.html#type-name" class="seealso">file:name()</a></code></li><li><code>FuncSpec = {Func, FuncState}</code></li><li><code>Func = <a href="#type-dbg_fun" class="seealso">dbg_fun()</a></code></li><li><code>FuncState = term()</code></li></ul>
      
      <div class="description">
        <p>This function can be used by a process that initiates a debug
          structure from a list of options. The values of the
          <code><anno>Opt</anno></code> argument are the same as the corresponding
          functions.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="get_debug/3">get_debug(Item, Debug, Default) -&gt; term()</h3>
      <ul class="type_desc"><li><code>Item = log | statistics</code></li><li><code>Debug = [<a href="#type-dbg_opt" class="seealso">dbg_opt()</a>]</code></li><li><code>Default = term()</code></li></ul>
      
      <div class="description">
        <p>This function gets the data associated with a debug option. <code><anno>Default</anno></code> is returned if the
          <code><anno>Item</anno></code> is not found.  Can be
          used by the process to retrieve debug data for printing
          before it terminates.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="handle_debug/4">handle_debug(Debug, FormFunc, Extra, Event) -&gt; [<a href="#type-dbg_opt" class="seealso">dbg_opt()</a>]</h3>
      <ul class="type_desc"><li><code>Debug = [<a href="#type-dbg_opt" class="seealso">dbg_opt()</a>]</code></li><li><code>FormFunc = <a href="#type-format_fun" class="seealso">format_fun()</a></code></li><li><code>Extra = term()</code></li><li><code>Event = <a href="#type-system_event" class="seealso">system_event()</a></code></li></ul>
      
      <div class="description">
        <p>This function is called by a process when it generates a
           system event. <code><anno>FormFunc</anno></code> is a formatting
           function which is called as <code><anno>FormFunc</anno>(Device,
           <anno>Event</anno>, <anno>Extra</anno>)</code> in order to print
           the events, which is necessary if tracing is activated.
           <code><anno>Extra</anno></code> is any extra information which the
           process needs in the format function, for example the name
           of the process.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="handle_system_msg/6">handle_system_msg(Msg, From, Parent, Module, Debug, Misc) -&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_return()</h3>
      <ul class="type_desc"><li><code>Msg = term()</code></li><li><code>From = {pid(), Tag :: term()}</code></li><li><code>Parent = pid()</code></li><li><code>Module = module()</code></li><li><code>Debug = [<a href="#type-dbg_opt" class="seealso">dbg_opt()</a>]</code></li><li><code>Misc = term()</code></li></ul>
      
      <div class="description">
        <p>This function is used by a process module that wishes to take care of system
          messages. The process receives a <code>{system, <anno>From</anno>, <anno>Msg</anno>}</code>
          message and passes the <code><anno>Msg</anno></code> and <code><anno>From</anno></code> to this
          function.
          </p>
        <p>This function <em>never</em> returns. It calls the function
          <code><anno>Module</anno>:system_continue(<anno>Parent</anno>, NDebug, <anno>Misc</anno>)</code> where the
          process continues the execution, or
          <code><anno>Module</anno>:system_terminate(Reason, <anno>Parent</anno>, <anno>Debug</anno>, <anno>Misc</anno>)</code> if
          the process should terminate. The <code><anno>Module</anno></code> must export
          <code>system_continue/3</code>, <code>system_terminate/4</code>,
          <code>system_code_change/4</code>, <code>system_get_state/1</code> and
          <code>system_replace_state/2</code> (see below).
          </p>
        <p>The <code><anno>Misc</anno></code> argument can be used to save internal data
          in a process, for example its state. It is sent to
          <code><anno>Module</anno>:system_continue/3</code> or
          <code><anno>Module</anno>:system_terminate/4</code></p>
      </div>
    </div>
    <div class="function">
      <h3 id="print_log/1">print_log(Debug) -&gt; ok</h3>
      <ul class="type_desc"><li><code>Debug = [<a href="#type-dbg_opt" class="seealso">dbg_opt()</a>]</code></li></ul>
      
      <div class="description">
        <p>Prints the logged system events in the debug structure
          using <code>FormFunc</code> as defined when the event was
          generated by a call to <code>handle_debug/4</code>.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="system_continue/3">Mod:system_continue(Parent, Debug, Misc) -&gt; none()</h3>
      
      <ul class="type">
        <li><code>Parent = pid()</code></li>
        <li><code>Debug = [<a href="#type-dbg_opt" class="seealso">dbg_opt()</a>]</code></li>
        <li><code>Misc = term()</code></li>
      </ul>
      <div class="description">
        <p>This function is called from <code>sys:handle_system_msg/6</code> when the process
          should continue its execution (for example after it has been
          suspended). This function never returns.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="system_terminate/4">Mod:system_terminate(Reason, Parent, Debug, Misc) -&gt; none()</h3>
      
      <ul class="type">
        <li><code>Reason = term()</code></li>
        <li><code>Parent = pid()</code></li>
        <li><code>Debug = [<a href="#type-dbg_opt" class="seealso">dbg_opt()</a>]</code></li>
        <li><code>Misc = term()</code></li>
      </ul>
      <div class="description">
        <p>This function is called from <code>sys:handle_system_msg/6</code> when the process
          should terminate. For example, this function is called when
          the process is suspended and its parent orders shut-down.
          It  gives the process a chance to do a clean-up. This function never
          returns.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="system_code_change/4">Mod:system_code_change(Misc, Module, OldVsn, Extra) -&gt; {ok, NMisc}</h3>
      
      <ul class="type">
        <li><code>Misc = term()</code></li>
        <li><code>OldVsn = undefined | term()</code></li>
        <li><code>Module = atom()</code></li>
        <li><code>Extra = term()</code></li>
        <li><code>NMisc = term()</code></li>
      </ul>
      <div class="description">
        <p>Called from <code>sys:handle_system_msg/6</code> when the process
          should perform a code change. The code change is used when the
          internal data structure has changed. This function
          converts the <code>Misc</code> argument to the new data
          structure. <code>OldVsn</code> is the <em>vsn</em> attribute of the
          old version of the <code>Module</code>. If no such attribute was
          defined, the atom <code>undefined</code> is sent.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="system_get_state/1">Mod:system_get_state(Misc) -&gt; {ok, State}</h3>
      
      <ul class="type">
        <li><code>Misc = term()</code></li>
        <li><code>State = term()</code></li>
    </ul>
      <div class="description">
        <p>This function is called from <code>sys:handle_system_msg/6</code> when the process
          should return a term that reflects its current state. <code>State</code> is the
          value returned by <code>sys:get_state/2</code>.</p>
      </div>
    </div>
    <div class="function">
      <h3 id="system_replace_state/2">Mod:system_replace_state(StateFun, Misc) -&gt; {ok, NState, NMisc}</h3>
      
      <ul class="type">
        <li><code>StateFun = fun((State :: term()) -&gt; NState)</code></li>
        <li><code>Misc = term()</code></li>
        <li><code>NState = term()</code></li>
        <li><code>NMisc = term()</code></li>
    </ul>
      <div class="description">
        <p>This function is called from <code>sys:handle_system_msg/6</code> when the process
         should replace its current state. <code>NState</code> is the value returned by
         <code>sys:replace_state/3</code>.</p>
      </div>
    </div>
  </div>

      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="../jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="../erldocs.js"></script>
  </body>
</html>
